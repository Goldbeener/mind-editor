# md编辑器

我想要做一个编辑器
本地的，不需要服务器信息，数据存储在本级

个人信息
  用户名 头像 
  是否需要密码？ 密码是做什么用的？

**页面组织**
1. 欢迎页
   1. 包含本编辑器的特色功能 features
2. 登录相关页面  创建一个用户吧
   1. 其实并不是真正的登录
   2. 补充用户的用户名、头像等信息
3. 真正的页面
   1. 三列布局
      1. 功能分类列 + 事件维度列 + 详细信息列【事件里程碑/编辑详情页】

使用tailwind 做css样式
使用pinia做状态管理

编辑页怎么布局？

# Features
1. 实时预览&双列预览切换
2. 事件维度的里程碑记录
3. **卡片风格** 
4. 笔记软链关系图谱
   1. 相互之间的关联 图示
   2. 类黑曜石的功能
   3. 实现思路
      1. glob扫描所有笔记文件
      2. ast识别出文件中的引用路径 md文档格式的引用链接，相对路径/非http协议开头的 确定应用关系
      3. 绘制关系图谱
5. 图片上传
   1. 读取剪切板内的图片，自动上传到7牛等图床，生成在线链接
   2. electron可以实现
6. 灵光一闪的想法 结合卡片风格 结合词云图等形式
   1. 想做什么东西
   2. 为什么想要做
   3. 有什么优点
7. 提前申明一些关键词，然后在编辑日记的时候，识别到关键词之后，给定提示，提示建立link关系
8. 主题切换 暗色模式、亮色模式


9. electron本地存储解决方案 `electron-store`
   1. 主要是存储用户的进入行为，根据行为决定展示feature页还是直接进入编辑页
   2. cocheDB




## 编辑器
+ 使用什么编辑器
+ 实时预览 写完直接编译

## markdown解析
+ marked 402k 
+ markdonw-it 553k
   
## electron本地存储
+ 使用什么方式存储
  + 存储用户的状态，是否第一次进来
    + 第一次： 展示欢迎页，
      + 标注出本编辑器的特点
      + 然后引导用户注册身份
    + 非第一次： 直接进入到编辑状态


# Q&A
## 1. 预加载脚本与渲染器的数据共享规则    
它们共享window变量，说是可以通过在window上挂载全局变量，实现渲染器能力增强    
但是因为`ContextIsolation`的存在，在渲染器中并不能直接访问到这些附加的全局变量，避免特权api泄漏到网页内容上

> 结构模型有点类似Chrome，渲染进程是运行在沙箱中的，不能访问到系统的能力
> preload脚本是能够使用系统能力的，渲染器进程不行，
> 那么preload因为语境隔离的问题，其实还是不能打破这个限制，
> 只是用来做一些提前工作

### ContextBridge
专门用来实现渲染器进程和主进程之间的交互
1. 暴露`ipcRenderer`到渲染器进程，然后实现进程间通信
2. 对那些使用url打开的页面，可以通过此api在widnow上挂载自定义属性，识别桌面环境，来做桌面定制化功能

```js
// packages/preload/src/index.ts
import type {BinaryLike} from 'crypto';
import {createHash} from 'crypto';

contextBridge.exposeInMainWorld('nodeCrypto', {
  sha256sum(data: BinaryLike) {
    const hash = createHash('sha256');
    hash.update(data);
    return hash.digest('hex');
  },
});
```
